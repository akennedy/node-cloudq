{"note":"Don't delete this file! It's used internally to help with page regeneration.","name":"Cloudq","tagline":"Cloudq Job Server in Node","google":"UA-9459466-2","body":"# cloudQ \r\n\r\n[![Build Status](https://secure.travis-ci.org/twilson63/node-cloudq.png)](http://travis-ci.org/twilson63/node-cloudq)\r\n\r\nA http message/job queue that is easy to queue, reserve and complete messages.\r\n\r\n## Install and Run Locally\r\n\r\nFirst, you need to install couchdb, you can download couchdb at [http://couchdb.apache.org/](http://couchdb.apache.org/)\r\n\r\n``` sh\r\nnpm install cloudq -g\r\nexport COUCH=http://localhost:5984/cloudq\r\nexport TOKEN=foo\r\nexport SECRET=bar\r\n\r\ncloudq\r\n```\r\n\r\n## Usage\r\n\r\nA job message queue server, allows your applications to push jobs to a queue, then\r\nworker applications can watch the queue and request for a job, when the worker\r\nreceives the job, it does the work, then sends a complete message back to the server.  Each job as a pre-defined schema that consists of two attributes:\r\n\r\n* klass\r\n* args\r\n\r\nThe klass attribute is a string represents the name of object that you wish to invoke.\r\nThe args attribute is an array of parameters that you wish to provide to that objects perform method.\r\n\r\n### job schema\r\n\r\n``` json\r\n{ \"job\":\r\n  {\r\n    \"klass\": \"Mailer\",\r\n    \"args\": [{\"to\": \"foo@email.com\", \"subject\": \"hello\"}]\r\n  }\r\n}\r\n```\r\n\r\n### add to queue\r\n\r\n``` sh\r\ncurl -XPUT -d '{ \"job\": { \"klass\": \"Mailer\", \"args\": [{\"to\": \"foo@email.com\", \"subject\": \"hello\"}]}}'\r\nhttp://cloudq.example.com/send_mail\r\n```\r\n\r\n### reserve job\r\n\r\n``` sh\r\ncurl http://cloudq.example.com/send_mail\r\n#>{ \"klass\": \"Mailer\", \"args\": [{\"to\": \"foo@email.com\", \"subject\": \"hello\"}], \"id\": \"1\"}\r\n```\r\n\r\n### complete\r\n\r\n``` sh\r\ncurl -XDELETE http://cloudq.example.com/send_mail/1\r\n#>{ \"status\": \"success\"}\r\n```\r\n\r\n### view\r\n\r\nWith the view api you can access any view in the couchdb database:\r\n\r\n``` sh\r\ncurl http://token:secret@localhost:3000/view/:name\r\n```\r\n\r\n### bulk\r\n\r\nWith the bulk api you can send a bulk update to couchdb\r\n\r\n``` sh\r\ncurl -XPUT http://token:secret@localhost:3000/bulk \\\r\n-d '[{\"_id\":\"1\",\"_rev\":\"1\", \"_deleted\": true}]' \\\r\n-H 'Content-Type: application/json'\r\n```\r\n\r\n# Authorization\r\n\r\nCurrently authorization is done by environment varables:\r\n\r\nTOKEN and SECRET\r\n\r\nTheses env variables should match with basic authentication, per request:\r\n\r\n``` sh\r\ncurl http://token:secret@localhost:3000/foo\r\n``` \r\n\r\nTest Successful Authentication:\r\n\r\n``` sh\r\ncurl -XPOST -d '{ \"job\": { \"klass\": \"Mailer\", \"args\": [{\"to\": \"foo@email.com\", \"subject\": \"hello\"}]}}' http://token:secret@cloudq.example.com/send_mail\r\n```\r\n\r\n---\r\n\r\n# Deploy\r\n\r\n## Deploy to nodejitsu\r\n\r\n``` sh\r\nmkdir mycloudq\r\ncd mycloudq\r\nnpm init\r\n# edit package.json and set \"node\": \"~0.6.x\"\r\nnpm install cloudq --save\r\necho 'require(\"cloudq/server\");' >> server.js\r\njitsu databases create couch cloudq\r\njitsu env set COUCH http://xxxx263878962530.iriscouch.com:5984/cloudq\r\njitsu env set TOKEN foo\r\njitsu env set SECRET bar\r\n\r\njitsu deploy\r\n```\r\n\r\n## Deploy to heroku\r\n``` sh\r\n# create an iriscouch account\r\nmkdir mycloudq\r\ncd mycloudq\r\nnpm init\r\n# edit package.json and set \"node\": \"~0.6.x\"\r\nnpm install cloudq --save\r\necho 'web: ./node_modules/cloudq/bin/cloudq' >> Procfile\r\necho 'node_modules' >> .gitignore\r\ngit init\r\ngit add .\r\ngit commit -am \"first commit\"\r\nheroku create\r\nheroku config:add COUCH=http://mydb.iriscouch.com/cloudq\r\nheroku config:add TOKEN=foo\r\nheroku config:add SECRET=bar\r\n\r\ngit push heroku master\r\n```\r\n\r\n## Deploy to cloudfoundry\r\n\r\n``` sh\r\n# create an iriscouch account\r\nmkdir mycloudq\r\ncd mycloudq\r\nnpm init\r\n# edit package.json and set \"node\": \"~0.6.x\"\r\nnpm install cloudq --save\r\necho 'require(\"cloudq/server\");' >> server.js\r\nvmc push mycloudq --no-start\r\nvmc env-add COUCH=http://mydb.iriscouch.com/cloudq\r\nvmc env-add TOKEN=foo\r\nvmc env-add TOKEN=bar\r\n\r\n\r\n```\r\n\r\n## Tests\r\n\r\n``` sh\r\nmocha\r\n```\r\n\r\n## License\r\n\r\nsee LICENSE\r\n\r\n## Contributing\r\n\r\nGOALS\r\n\r\n1. ONLY THREE CORE API METHODS\r\n\r\n* POST /queue - PUSH a JOB on the QUEUE\r\n* GET /queue - RESERVE a JOB\r\n* DELETE /queue/id - MARK JOB as Completed\r\n\r\n* view api\r\n* bulk update api\r\n* prioritization\r\n* expiration job module\r\n\r\nTODO\r\n\r\n* tokens authorization\r\n* create acl for queues, views, bulk updates\r\n\r\n"}